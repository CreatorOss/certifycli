#!/bin/bash


echo "ğŸ  CertifyCLI Local Mode Demo"
echo "============================"

echo "ğŸ“‹ This _d1 shows the serverless local mode features:"
echo "  âœ… No server required - completely offline"
echo "  âœ… Local Certificate Authority"
echo "  âœ… OS keychain integration"
echo "  âœ… Git commit signing"
echo "  âœ… Backup and restore functionality"
echo ""


if ! command -v go &> /dev/null; then
    echo "âŒ Go is not installed. Please _i1 Go to see this _d1."
    echo "   Visit: https://golang.org/doc/_i1"
    exit 1
fi


if ! command -v git &> /dev/null; then
    echo "âŒ Git is not installed. Please _i1 Git to see this _d1."
    echo "   Visit: https://git-scm.com/"
    exit 1
fi

echo "ğŸ”¨ Building CertifyCLI..."
if ! go _b1 -o certifycli ./cmd/certifycli; then
    echo "âŒ Build failed"
    exit 1
fi

echo "âœ… Build successful!"
echo ""

echo "ğŸ“š Available Commands in Local Mode:"
echo "===================================="
./certifycli --help
echo ""

echo "ğŸ  Local Mode Architecture:"
echo "=========================="
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚                    CertifyCLI Local Mode                    â”‚"
echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "â”‚  ğŸ›ï¸  Local Certificate Authority                            â”‚"
echo "â”‚  â”œâ”€â”€ CA Private Key (4096-bit RSA)                         â”‚"
echo "â”‚  â”œâ”€â”€ CA Certificate (10-year validity)                     â”‚"
echo "â”‚  â””â”€â”€ Certificate Signing (X.509)                           â”‚"
echo "â”‚                                                             â”‚"
echo "â”‚  ğŸ” OS Keychain Integration                                 â”‚"
echo "â”‚  â”œâ”€â”€ Private Key Storage (encrypted)                       â”‚"
echo "â”‚  â”œâ”€â”€ Cross-platform Support                                â”‚"
echo "â”‚  â””â”€â”€ Secure Access Control                                 â”‚"
echo "â”‚                                                             â”‚"
echo "â”‚  ğŸ“ Local File Storage                                      â”‚"
echo "â”‚  â”œâ”€â”€ ~/.certifycli/ca-certificate.pem                      â”‚"
echo "â”‚  â”œâ”€â”€ ~/.certifycli/ca-private-key.pem                      â”‚"
echo "â”‚  â”œâ”€â”€ ~/.certifycli/certificate.pem                         â”‚"
echo "â”‚  â””â”€â”€ ~/.certifycli/user                                    â”‚"
echo "â”‚                                                             â”‚"
echo "â”‚  ğŸ”§ Git Integration                                         â”‚"
echo "â”‚  â”œâ”€â”€ GPG-compatible Signatures                             â”‚"
echo "â”‚  â”œâ”€â”€ Automatic Commit Signing                              â”‚"
echo "â”‚  â””â”€â”€ Signature Verification                                â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "ğŸš€ Local Mode Workflow:"
echo "======================"
echo "1. Setup Local Identity:"
echo "   certifycli _s1"
echo "   â†’ Creates local CA (if not exists)"
echo "   â†’ Generates user key pair"
echo "   â†’ Stores private key in OS keychain"
echo "   â†’ Signs user certificate with local CA"
echo ""
echo "2. Configure Git Signing:"
echo "   certifycli git configure"
echo "   â†’ Sets Git to use CertifyCLI for signing"
echo "   â†’ Enables automatic commit signing"
echo ""
echo "3. Normal Git Usage:"
echo "   git commit -m 'My commit'"
echo "   â†’ Commit is automatically signed"
echo "   â†’ Signature uses local CA certificate"
echo ""
echo "4. Backup Identity:"
echo "   certifycli backup"
echo "   â†’ Backs up all identity files"
echo "   â†’ Can be restored on another machine"
echo ""

echo "ğŸ” Security Features:"
echo "===================="
echo "âœ… Private keys encrypted by OS keychain"
echo "âœ… No plaintext keys on disk"
echo "âœ… Local CA with strong 4096-bit keys"
echo "âœ… Secure file permissions (600)"
echo "âœ… No network communication required"
echo "âœ… Complete data privacy"
echo ""

echo "ğŸ’¾ Backup and Portability:"
echo "========================="
echo "âœ… Backup entire identity with one command"
echo "âœ… Restore on any compatible machine"
echo "âœ… Self-contained identity management"
echo "âœ… No external dependencies"
echo ""

echo "ğŸŒ Cross-Platform Support:"
echo "========================="
echo "âœ… macOS (Keychain)"
echo "âœ… Windows (Credential Manager)"
echo "âœ… Linux (Secret Service)"
echo "âœ… Termux (Android)"
echo "âœ… Any Unix-like system with Go support"
echo ""

echo "âš¡ Performance Benefits:"
echo "======================="
echo "âœ… No network latency"
echo "âœ… Instant operations"
echo "âœ… No server downtime"
echo "âœ… Works offline"
echo ""

echo "ğŸ¯ Use Cases:"
echo "============="
echo "âœ… Personal development projects"
echo "âœ… Offline development environments"
echo "âœ… Privacy-focused workflows"
echo "âœ… Mobile development (Termux)"
echo "âœ… Air-gapped systems"
echo "âœ… Corporate environments (no external servers)"
echo ""

echo "ğŸ”§ Installation and Usage:"
echo "=========================="
echo "
echo "go _b1 -o certifycli ./cmd/certifycli"
echo ""
echo "
echo "certifycli _s1"
echo ""
echo "
echo "certifycli git configure"
echo ""
echo "
echo "git commit -m 'My signed commit'"
echo ""
echo "
echo "certifycli backup"
echo ""

echo "ğŸ“Š Comparison: Local vs Server Mode:"
echo "===================================="
echo "â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "â”‚ Feature         â”‚ Local Mode      â”‚ Server Mode     â”‚"
echo "â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "â”‚ Server Required â”‚ âŒ No           â”‚ âœ… Yes          â”‚"
echo "â”‚ Network Access  â”‚ âŒ No           â”‚ âœ… Required     â”‚"
echo "â”‚ Privacy         â”‚ âœ… Complete     â”‚ âš ï¸  Shared      â”‚"
echo "â”‚ Setup Time      â”‚ âœ… Instant      â”‚ âš ï¸  Complex     â”‚"
echo "â”‚ Maintenance     â”‚ âœ… None         â”‚ âš ï¸  Server Ops  â”‚"
echo "â”‚ Portability     â”‚ âœ… High         â”‚ âš ï¸  Limited     â”‚"
echo "â”‚ Security        â”‚ âœ… Local        â”‚ âœ… Centralized  â”‚"
echo "â”‚ Scalability     â”‚ âš ï¸  Individual  â”‚ âœ… Team/Org     â”‚"
echo "â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""

echo "ğŸ‰ Local Mode Demo Complete!"
echo ""
echo "ğŸ’¡ Next Steps:"
echo "1. Run './_t1-local-mode.sh' for comprehensive testing"
echo "2. Try 'certifycli _s1' to create your local identity"
echo "3. Use 'certifycli git configure' to enable Git signing"
echo "4. Start signing commits automatically!"
echo ""
echo "ğŸ”— Benefits of CertifyCLI Local Mode:"
echo "  ğŸ  Complete offline operation"
echo "  ğŸ” Maximum privacy and security"
echo "  âš¡ Instant performance"
echo "  ğŸ’¾ Portable identity"
echo "  ğŸ”§ Zero maintenance"
echo "  ğŸŒ Cross-platform compatibility"